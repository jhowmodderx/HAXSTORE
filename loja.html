<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>HAX STORE</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { font-family: Arial, sans-serif; background-color: #0c0c0c; color: #fff; }

    header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      background-color: #111;
      padding: 15px 20px;
      border-bottom: 2px solid #e50914;
    }

    .logo { color: #e50914; font-size: 22px; font-weight: bold; }

    .header-buttons {
        display: flex;
        gap: 10px; /* Espaçamento entre os botões */
    }

    .discord-btn, .admin-panel-btn {
      background: transparent;
      border: 2px solid #e50914;
      color: #e50914;
      padding: 8px 16px;
      border-radius: 6px;
      cursor: pointer;
      transition: 0.3s;
    }

    .discord-btn:hover, .admin-panel-btn:hover {
      background-color: #e50914;
      color: white;
    }

    .banner {
      height: 250px;
      background: url('https://i.imgur.com/xklvTL7.png') no-repeat center center;
      background-size: cover;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .banner h2 {
      background-color: rgba(0, 0, 0, 0.6);
      border: 2px solid #e50914;
      color: #e50914;
      padding: 12px 24px;
      border-radius: 8px;
      font-size: 20px;
      font-weight: bold;
    }

    .content {
      padding: 30px 20px;
      max-width: 900px;
      margin: 0 auto;
    }

    .tag {
      display: inline-block;
      background-color: #e50914;
      color: white;
      padding: 4px 10px;
      border-radius: 4px;
      font-size: 12px;
      text-transform: uppercase;
      margin-bottom: 10px;
    }

    .produto-item {
      background-color: #1a1a1a;
      border: 1px solid #222;
      padding: 20px;
      margin-bottom: 20px;
      border-radius: 8px;
      position: relative; /* Para o botão de apagar */
    }

    .produto-titulo { font-size: 28px; font-weight: bold; margin: 10px 0; }
    .produto-desc { color: #ccc; margin-bottom: 15px; line-height: 1.6; }

    .precos {
      margin-bottom: 15px;
    }

    .preco-antigo { text-decoration: line-through; color: #888; font-size: 16px; }
    .preco-atual { color: #e50914; font-size: 28px; font-weight: bold; }

    .btn-comprar {
      background-color: #e50914;
      color: white;
      border: none;
      padding: 12px 24px;
      font-size: 16px;
      border-radius: 6px;
      cursor: pointer;
      transition: 0.3s;
    }

    .btn-comprar:hover {
      background-color: #b20710;
    }

    .btn-delete-produto {
      background-color: #cc0000;
      color: white;
      border: none;
      padding: 5px 10px;
      border-radius: 4px;
      cursor: pointer;
      position: absolute;
      top: 10px;
      right: 10px;
      font-size: 12px;
    }

    .btn-delete-produto:hover {
        background-color: #990000;
    }

    .btn-edit-produto {
      background-color: #007bff;
      color: white;
      border: none;
      padding: 5px 10px;
      border-radius: 4px;
      cursor: pointer;
      position: absolute;
      top: 10px;
      right: 60px; /* Ajuste para não sobrepor o delete */
      font-size: 12px;
      margin-right: 5px;
    }

    .btn-edit-produto:hover {
        background-color: #0056b3;
    }

    footer {
      background-color: #111;
      text-align: center;
      padding: 15px;
      color: #777;
      margin-top: 40px;
      font-size: 14px;
    }

    /* Modals */
    .modal {
      display: none;
      position: fixed;
      z-index: 1000;
      left: 0; top: 0;
      width: 100%; height: 100%;
      background-color: rgba(0, 0, 0, 0.8);
      justify-content: center;
      align-items: center;
    }

    .modal-content {
      background-color: #111;
      padding: 20px;
      border-radius: 10px;
      text-align: center;
      width: 90%;
      max-width: 400px;
      border: 2px solid #e50914;
      position: relative; /* Para o botão de fechar */
    }

    .modal-content.admin-modal {
        max-width: 600px; /* Mais largo para o painel de admin */
        border: 2px solid #0f0; /* Borda verde para o modal admin */
    }

    .modal-content h3 {
      color: #e50914;
      margin-bottom: 15px;
    }
    .modal-content.admin-modal h3 {
        color: #0f0; /* Título do modal admin verde */
    }

    .pix-key {
      background-color: #222;
      padding: 10px;
      border-radius: 6px;
      font-size: 14px;
      word-wrap: break-word;
      margin-bottom: 15px;
      border: 1px solid #e50914;
    }

    .btn-confirmar {
      background-color: #e50914;
      border: none;
      color: white;
      padding: 10px 20px;
      border-radius: 6px;
      cursor: pointer;
    }

    .mensagem-final {
      margin-top: 20px;
      color: #0f0;
      font-weight: bold;
      display: none;
    }

    .close-button {
      position: absolute;
      top: 10px;
      right: 20px;
      color: #aaa;
      font-size: 28px;
      font-weight: bold;
      cursor: pointer;
    }

    .close-button:hover,
    .close-button:focus {
      color: #fff;
      text-decoration: none;
      cursor: pointer;
    }

    /* Estilos de Administração (dentro do modal agora) */
    .admin-section input[type="text"],
    .admin-section input[type="number"],
    .admin-section textarea {
      width: calc(100% - 20px);
      padding: 10px;
      margin-bottom: 10px;
      background-color: #222;
      border: 1px solid #333;
      color: #fff;
      border-radius: 4px;
    }

    .admin-section button {
      background-color: #0f0; /* Botão verde */
      color: #111;
      border: none;
      padding: 10px 20px;
      border-radius: 5px;
      cursor: pointer;
      margin-right: 10px;
    }

    .admin-section button:hover {
      background-color: #00cc00;
    }

    .admin-products-list {
      margin-top: 20px;
      max-height: 200px; /* Limita a altura para rolagem */
      overflow-y: auto; /* Adiciona barra de rolagem se necessário */
      padding-right: 10px; /* Espaço para a barra de rolagem */
    }

    .admin-product-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      background-color: #222;
      padding: 10px;
      border-radius: 5px;
      margin-bottom: 10px;
    }

    .admin-product-item span {
      flex-grow: 1;
      text-align: left; /* Alinha texto à esquerda */
    }

    .admin-product-item button {
      margin-left: 10px;
      padding: 5px 10px;
      font-size: 14px;
      flex-shrink: 0; /* Evita que os botões diminuam */
    }

    .admin-warning-message {
        background-color: #e50914;
        color: white;
        padding: 10px;
        border-radius: 5px;
        margin-bottom: 20px;
        text-align: center;
        font-weight: bold;
    }

    .warning-item {
        background-color: #333;
        padding: 10px;
        border-radius: 5px;
        margin-bottom: 10px;
        display: flex;
        justify-content: space-between;
        align-items: center;
    }

    .admin-warnings-list {
        max-height: 200px;
        overflow-y: auto;
        padding-right: 10px;
    }

    /* Estilos para as abas de administração */
    .admin-tabs {
        display: flex;
        margin-bottom: 20px;
        border-bottom: 1px solid #0f0;
    }

    .admin-tab-button {
        background-color: #333;
        color: #0f0;
        padding: 10px 15px;
        border: none;
        cursor: pointer;
        border-top-left-radius: 8px;
        border-top-right-radius: 8px;
        margin-right: 5px;
        transition: background-color 0.3s;
    }

    .admin-tab-button.active {
        background-color: #0f0;
        color: #111;
    }

    .admin-tab-content {
        display: none; /* Esconde todas as abas por padrão */
        text-align: left; /* Alinha o conteúdo da aba à esquerda */
    }

    .admin-tab-content.active {
        display: block; /* Mostra a aba ativa */
    }
  </style>
</head>
<body>

  <header>
    <div class="logo">HAX STORE</div>
    <div class="header-buttons">
        <button class="discord-btn">Entrar no Discord</button>
        <button id="adminPanelBtn" class="admin-panel-btn" style="display: none;">Painel de Administração</button>
    </div>
  </header>

  <div class="content">
    <div id="warnings-container">
      </div>
    <div id="products-container">
      </div>
  </div>

  <footer>
    &copy; 2025 HAX STORE. Todos os direitos reservados.
  </footer>

  <div class="modal" id="pixModal">
    <div class="modal-content">
      <span class="close-button" onclick="closePixModal()">&times;</span>
      <h3>Pagamento via PIX</h3>
      <div class="pix-key" id="pixChave"></div> <button class="btn-confirmar" onclick="confirmarPagamento()">Confirmar pagamento</button>
      <div class="mensagem-final" id="mensagemFinal">HAX STORE - ENVIE O COMPROVANTE NO TICKET</div>
    </div>
  </div>

  <div class="modal" id="adminModal">
    <div class="modal-content admin-modal">
        <span class="close-button" onclick="closeAdminModal()">&times;</span>
        <h3>Painel de Administração</h3>

        <div class="admin-tabs">
            <button class="admin-tab-button active" onclick="openAdminTab(event, 'manage-products')">Gerenciar Produtos</button>
            <button class="admin-tab-button" onclick="openAdminTab(event, 'manage-warnings')">Gerenciar Avisos</button>
            <button class="admin-tab-button" onclick="openAdminTab(event, 'manage-pix')">Configurar PIX</button>
        </div>

        <div id="manage-products" class="admin-tab-content active">
            <h4>Adicionar/Editar Produto</h4>
            <input type="hidden" id="productIdToEdit">
            <input type="text" id="productTitle" placeholder="Título do Produto" required>
            <textarea id="productDesc" placeholder="Descrição do Produto" rows="3"></textarea>
            <input type="number" id="productOldPrice" placeholder="Preço Antigo (Ex: 30.00)" step="0.01">
            <input type="number" id="productNewPrice" placeholder="Preço Atual (Ex: 10.00)" step="0.01" required>
            <button onclick="saveProduct()">Salvar Produto</button>
            <button onclick="clearProductForm()">Limpar Formulário</button>

            <h4>Produtos Existentes</h4>
            <div id="admin-products-list">
            </div>
        </div>

        <div id="manage-warnings" class="admin-tab-content">
            <h4>Gerenciar Avisos</h4>
            <input type="text" id="warningMessage" placeholder="Nova mensagem de aviso">
            <button onclick="addWarning()">Adicionar Aviso</button>
            <div id="admin-warnings-list">
            </div>
        </div>

        <div id="manage-pix" class="admin-tab-content">
            <h4>Chave PIX Atual</h4>
            <input type="text" id="currentPixKey" placeholder="Chave PIX atual" readonly>
            <h4>Nova Chave PIX</h4>
            <input type="text" id="newPixKey" placeholder="Nova Chave PIX">
            <button onclick="updatePixKey()">Salvar Chave PIX</button>
        </div>
    </div>
  </div>

  <script>
    const productsContainer = document.getElementById('products-container');
    const adminPanelBtn = document.getElementById('adminPanelBtn'); // Novo botão na header
    const adminModal = document.getElementById('adminModal'); // Novo modal de administração
    const adminProductsList = document.getElementById('admin-products-list');
    const warningsContainer = document.getElementById('warnings-container');
    const adminWarningsList = document.getElementById('admin-warnings-list');
    const pixChaveDisplay = document.getElementById('pixChave'); // PIX no modal de compra
    const newPixKeyInput = document.getElementById('newPixKey'); // PIX no painel admin
    const currentPixKeyDisplay = document.getElementById('currentPixKey'); // PIX no painel admin

    // --- Funções Iniciais e Verificação de Admin ---
    document.addEventListener('DOMContentLoaded', () => {
        const isAdmin = localStorage.getItem('isAdmin') === 'true';
        if (isAdmin) {
            adminPanelBtn.style.display = 'block'; // Mostra o botão "Painel de Administração"
            // Não carrega adminPanel diretamente no DOM, ele será um modal
            loadAdminProducts();
            loadAdminWarnings();
            loadPixKeyForAdmin();
        }

        renderProducts();
        renderWarnings();
        updatePixKeyDisplay(); // Atualiza a chave PIX no modal de compra para todos os usuários
    });

    // --- Funções do Modal PIX (compra) ---
    function abrirModal() {
      updatePixKeyDisplay(); // Garante que a chave PIX no modal está atualizada
      document.getElementById('pixModal').style.display = 'flex';
    }

    function closePixModal() {
      document.getElementById('pixModal').style.display = 'none';
      document.getElementById('mensagemFinal').style.display = "none";
    }

    function confirmarPagamento() {
      const mensagem = document.getElementById('mensagemFinal');
      mensagem.style.display = 'block';
    }

    // --- Funções do Modal de Administração ---
    adminPanelBtn.addEventListener('click', () => {
        adminModal.style.display = 'flex';
        // Garante que a primeira aba e os dados sejam carregados ao abrir o modal
        openAdminTab(null, 'manage-products');
        loadAdminProducts();
        loadAdminWarnings();
        loadPixKeyForAdmin();
    });

    function closeAdminModal() {
      adminModal.style.display = 'none';
    }

    // Fecha modais ao clicar fora (geral para ambos)
    window.onclick = function(event) {
      const pixModal = document.getElementById('pixModal');
      const adminModal = document.getElementById('adminModal');

      if (event.target == pixModal) {
        closePixModal();
      }
      if (event.target == adminModal) {
        closeAdminModal();
      }
    }
    
    // --- Funções de Produtos ---
    function getProducts() {
      return JSON.parse(localStorage.getItem('products') || '[]');
    }

    function saveProducts(products) {
      localStorage.setItem('products', JSON.stringify(products));
    }

    function renderProducts() {
      const products = getProducts();
      productsContainer.innerHTML = ''; // Limpa antes de renderizar
      const isAdmin = localStorage.getItem('isAdmin') === 'true';

      if (products.length === 0 && !isAdmin) {
          productsContainer.innerHTML = '<p style="text-align: center; color: #ccc;">Nenhum produto disponível no momento.</p>';
          return;
      }

      products.forEach((product, index) => {
        const productDiv = document.createElement('div');
        productDiv.className = 'produto-item';
        productDiv.innerHTML = `
          <span class="tag">Em destaque</span>
          <h1 class="produto-titulo">${product.title}</h1>
          <p class="produto-desc">${product.description}</p>
          <div class="precos">
            ${product.oldPrice && product.oldPrice > 0 ? `<span class="preco-antigo">R$ ${product.oldPrice.toFixed(2).replace('.', ',')}</span><br>` : ''}
            <span class="preco-atual">R$ ${product.newPrice.toFixed(2).replace('.', ',')}</span>
          </div>
          <button class="btn-comprar" data-product-id="${index}">Comprar agora</button>
        `;
        productsContainer.appendChild(productDiv);
      });

      // Adiciona event listeners para os botões de compra (após a renderização)
      document.querySelectorAll('.btn-comprar').forEach(button => {
        button.addEventListener('click', (event) => {
          if (!localStorage.getItem('loggedUser')) {
            alert('Você precisa estar logado para comprar.');
            window.location.href = 'index.html';
          } else {
            abrirModal();
          }
        });
      });
    }

    function loadAdminProducts() {
        const products = getProducts();
        adminProductsList.innerHTML = '';
        if (products.length === 0) {
            adminProductsList.innerHTML = '<p style="color: #888;">Nenhum produto cadastrado.</p>';
            return;
        }
        products.forEach((product, index) => {
            const productItem = document.createElement('div');
            productItem.className = 'admin-product-item';
            productItem.innerHTML = `
                <span>${product.title} - R$ ${product.newPrice.toFixed(2).replace('.', ',')}</span>
                <div>
                    <button class="btn-edit-produto" onclick="editProduct(${index})">Editar</button>
                    <button class="btn-delete-produto" onclick="deleteProduct(${index})">Apagar</button>
                </div>
            `;
            adminProductsList.appendChild(productItem);
        });
    }

    function saveProduct() {
        const idToEdit = document.getElementById('productIdToEdit').value;
        const title = document.getElementById('productTitle').value.trim();
        const description = document.getElementById('productDesc').value.trim();
        const oldPrice = parseFloat(document.getElementById('productOldPrice').value) || 0;
        const newPrice = parseFloat(document.getElementById('productNewPrice').value);

        if (!title || !description || isNaN(newPrice) || newPrice <= 0) {
            alert('Por favor, preencha todos os campos obrigatórios (Título, Descrição, Preço Atual) e o preço deve ser um número positivo.');
            return;
        }

        const products = getProducts();
        if (idToEdit !== '') { // Verifica se há um ID para edição
            // Editando produto existente
            products[idToEdit] = { title, description, oldPrice, newPrice };
        } else {
            // Adicionando novo produto
            products.push({ title, description, oldPrice, newPrice });
        }
        saveProducts(products);
        clearProductForm();
        renderProducts();
        loadAdminProducts();
        alert('Produto salvo com sucesso!');
    }

    function editProduct(index) {
        const products = getProducts();
        const product = products[index];
        document.getElementById('productIdToEdit').value = index;
        document.getElementById('productTitle').value = product.title;
        document.getElementById('productDesc').value = product.description;
        document.getElementById('productOldPrice').value = product.oldPrice;
        document.getElementById('productNewPrice').value = product.newPrice;
    }

    function deleteProduct(index) {
        if (confirm('Tem certeza que deseja apagar este produto?')) {
            const products = getProducts();
            products.splice(index, 1); // Remove o produto do array
            saveProducts(products);
            renderProducts();
            loadAdminProducts();
            alert('Produto apagado!');
        }
    }

    function clearProductForm() {
        document.getElementById('productIdToEdit').value = '';
        document.getElementById('productTitle').value = '';
        document.getElementById('productDesc').value = '';
        document.getElementById('productOldPrice').value = '';
        document.getElementById('productNewPrice').value = '';
    }

    // --- Funções de Avisos ---
    function getWarnings() {
      return JSON.parse(localStorage.getItem('warnings') || '[]');
    }

    function saveWarnings(warnings) {
      localStorage.setItem('warnings', JSON.stringify(warnings));
    }

    function renderWarnings() {
        const warnings = getWarnings();
        warningsContainer.innerHTML = '';
        warnings.forEach((warning, index) => {
            const warningDiv = document.createElement('div');
            warningDiv.className = 'admin-warning-message';
            warningDiv.textContent = warning;
            warningsContainer.appendChild(warningDiv);
        });
    }

    function loadAdminWarnings() {
        const warnings = getWarnings();
        adminWarningsList.innerHTML = '';
        if (warnings.length === 0) {
            adminWarningsList.innerHTML = '<p style="color: #888;">Nenhum aviso cadastrado.</p>';
            return;
        }
        warnings.forEach((warning, index) => {
            const warningItem = document.createElement('div');
            warningItem.className = 'warning-item';
            warningItem.innerHTML = `
                <span>${warning}</span>
                <button class="btn-delete-produto" onclick="deleteWarning(${index})">Apagar</button>
            `;
            adminWarningsList.appendChild(warningItem);
        });
    }

    function addWarning() {
        const message = document.getElementById('warningMessage').value.trim();
        if (!message) {
            alert('Por favor, digite uma mensagem para o aviso.');
            return;
        }
        const warnings = getWarnings();
        warnings.push(message);
        saveWarnings(warnings);
        document.getElementById('warningMessage').value = '';
        renderWarnings();
        loadAdminWarnings();
        alert('Aviso adicionado com sucesso!');
    }

    function deleteWarning(index) {
        if (confirm('Tem certeza que deseja apagar este aviso?')) {
            const warnings = getWarnings();
            warnings.splice(index, 1);
            saveWarnings(warnings);
            renderWarnings();
            loadAdminWarnings();
            alert('Aviso apagado!');
        }
    }

    // --- Funções de PIX ---
    function getPixKey() {
        // Retorna a chave PIX, ou uma padrão se não houver
        return localStorage.getItem('pixKey') || '473d4931-6f15-4ab6-bf59-571f6c3a368d';
    }

    function savePixKey(key) {
        localStorage.setItem('pixKey', key);
    }

    function updatePixKeyDisplay() {
        // Atualiza a chave PIX exibida no modal de compra para o usuário
        pixChaveDisplay.textContent = getPixKey();
    }

    function loadPixKeyForAdmin() {
        // Carrega a chave PIX no campo de texto para o admin no modal de admin
        currentPixKeyDisplay.value = getPixKey();
    }

    function updatePixKey() {
        const newKey = newPixKeyInput.value.trim();
        if (!newKey) {
            alert('Por favor, digite uma nova chave PIX.');
            return;
        }
        savePixKey(newKey);
        newPixKeyInput.value = '';
        currentPixKeyDisplay.value = newKey; // Atualiza o campo de visualização no admin
        updatePixKeyDisplay(); // Atualiza a chave no modal de compra
        alert('Chave PIX atualizada com sucesso!');
    }

    // --- Funções de Abas do Painel de Administração ---
    function openAdminTab(evt, tabName) {
        let i, tabcontent, tablinks;
        tabcontent = adminModal.getElementsByClassName("admin-tab-content");
        for (i = 0; i < tabcontent.length; i++) {
            tabcontent[i].style.display = "none";
        }
        tablinks = adminModal.getElementsByClassName("admin-tab-button");
        for (i = 0; i < tablinks.length; i++) {
            tablinks[i].className = tablinks[i].className.replace(" active", "");
        }
        document.getElementById(tabName).style.display = "block";
        if (evt) { // Evita erro se chamado sem evento (no DOMContentLoaded)
            evt.currentTarget.className += " active";
        } else { // Se for a chamada inicial, ativa o primeiro botão
            adminModal.querySelector('.admin-tab-button').className += " active";
        }
    }
  </script>

</body>
</html>